SQL Queries (13-6-24)

1)

Select * from employees
offset 5 rows

2)

Select emp_name,emp_doj
where emp_doj = (select max(emp_doj) from employee)

3)

select emp_name,dept_name,min(salary) 
from employee
group by emp_name,dept_name

4)

select * from employees
offset (select count(*) - 4 from employees) rows

5)

select * from employees
fetch 1 rows only
union
select * from employees
offset(select count(*) -1 from employees);

6)

select * from employee
where mod(emp_id,2) = 1;

7)
select emp_name,salary
from(select emp_name,salary,dense_rank() over(order by salary desc) rnk
from employees)
where rnk = 5;

8)
select emp_name,emp_sal
from employee e1
where 2 = (select count(distinct e2.emp_sal) from employee 2
where e2.emp_sal>e1.emp_sal)

9)

select * from employee
fetch first 10 rows only

10)
select emp_name,emp_salr 
from(
select emp_name,emp_sal dense_rank()over(order by emp_sal desc)rnk
from employee)
where rnk < 6;


11)

with ord_emp as(
select e.* ,row_number() over (order by emp_id) rn
from employees)

select emp_id,emp_name
from ord_emp
where rn in (2,3,4,5,7,9)

12)

with ord_emp as(
select e.* ,row_number() over (order by emp_id) rn
from employees)
select * from ord_emp
where rn = 2
------------------------------------------------------------------------------------------

1	How many rows returned in		
	Normal Join		
	Left join 		
	Right join		
	Full outer join		
	union		
	union all		
			
	Table A	Table B	
	1	1	
	1	2	
	2	2	

Normal Join - 4

Left join   - 4

Right join  - 4

Full outer
join 	    - 4

union 	    - 2
union all   - 6

					
2)	Write a select query to generate this output				
Input	Dept_id	emp_id	emp_name	Salary	
	D1	E1			100	
	D1	E2			200	
	D1	E3			300	
					
Output	Dept_id	emp_id	running salary	Dept_salary	
	D1	E1	100		600	
	D1	E2	200		600	
	D1	E3	300		600	



select dept_id,emp_id,salary as running_salary,
sum(salary) over(partition by dept_id)as dept_id
from employee



3)
	Write a delete query delete duplicates		
	ID	Name	Location
	1	ABC	Bangalore
	1	ABC	Bangalore
	1	ABC	Bangalore
	2	DEF	USA
	2	DEF	USA


delete from table
where rowid not in  (select min (rowid) 
from table
group by id)


4)Write a query to extract year,month and quarter from current date			

select extract(year from sysdate) as year,extract(month from sysdate) as month,
to_char(sysdate,'Q') as quarter from dual;


5)

insert all 
	into table_name(col1,col1) values(val1,val2)
	into table_name(col1,col1) values(val1,val2)

6)

select emp_name,
floor(months_between(sysdate,dob)/12) as age
from table
where floor(months_between(sysdate,dob)/12) >89

7)

delete from table
where rowid not in(select min(rowid) from table
group by doc_id,doc_name,specialty,gender)


8)
select extract(year from date_visit),doc_id,
avg(count(pat_id) over(partition by doc_id),extract(year from date_vitis))as avg_visit
from patient
group by
extract(year from date_visit),doc_id


9)
select doc_id from 
doctor
where doc_id not in(select doc_id from patients)


10)
update doctor
set gender = 
case  when gender == 'Male' then 'M' 
       when gender == 'Female' then'F'
       when gender == 'Unknown' then 'U'
	else gender
end;



	
	


 



